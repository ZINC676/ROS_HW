# ROSbag
rosbag软件包提供了一个用于处理包的命令行工具

## 简介
.bag文件可以保存ros系统运行过程中产生的话题和服务数据，并可以播放出来以供其他系统使用，有种仿真器的感觉，在使用 别人数据集的过程中十分有用。bag提供了一个途径，工作原理便是将正在运行的ROS系统中的数据记录到一个.bag文件中，然后回放这些数据，以在运行的系统中产生类似的数据流。


## 实例-记录数据

1. 打开两个终端并运行

```
roscore
rosrun turtlesim turtlesim_node
rosrun turtlesim turtle_teleop_key
```


这时便会生成两个节点，一个用于可视化小海龟，另一个用于读取键盘的指令。在终端3下通过按上下左右即可控制乌龟的运动方向。

2. 查看一下此时系统发布的所有的话题，需要新打开一个终端：

```
rostopic list -v
```

3. 使用bag记录数据
这里显示了所有发布和接受到的话题名称及数据类型，接下来只记录发布的消息。
下面开始记录这些数据，新打开一个终端，运行：

```
rosbag record -a
```

这里创建一个临时bagfiles来记录数据，然后运行带有-a选项的rosbag record，-a表示所有发布的主题都应该保存在一个bag文件中。

现在通过键盘移动小海龟，大约10s钟即可
在运行rosbag record exit的窗口中，使用Ctrl-C键以停止程序。现在检查目录~/bagfiles的内容。您应该看到一个文件，文件名以年份、日期和时间开头，后缀为.bag。这是一个bag文件，包含运行rosbag记录时任何节点发布的所有主题。

## 实例-回放数据

1. 查看bag文件信息：
在bag文件路径下打开终端，根据自己bag名称运行一下命令：

```
rosbag info 2020-07-04-11-01-11.bag
```

它告诉我们主题名称和类型以及包文件中包含的每个消息主题的数量

2. 运行bag数据：

```
rosbag play 2020-07-04-11-01-11.bag
```

这时终端会输出很多消息
此时因为接收到了新的消息，小海龟开始自己移动了

**总结：以上便是bag的基础用法，若想了解进阶用法请上roswiki**